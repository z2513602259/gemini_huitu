# 产品替换模板实现方案

## 需求
在工作流模式中添加"产品替换"模板，用于将产品图放入场景图中。

## 模板信息
- **ID**: `product-replace`
- **名称**: 产品替换
- **图标**: 🔄 (或其他合适的图标)
- **描述**: 替换场景中的产品
- **提示词**: 将图1的产品放到图2的场景中，替换原有的产品，重新打光，使产品和场景融合自然，有自然光影，产品保持一致，去除场景中的文字和logo

## 特殊要求
- 需要用户上传两张图片
- 第一张图片 = 产品图（图1）
- 第二张图片 = 场景图（图2）
- 需要在 UI 中添加提示说明图片上传顺序

## 实现步骤

### 1. 在 WORKFLOW_TEMPLATES 数组中添加新模板

在 [`App.tsx`](image-gen-app/src/App.tsx:51) 的 `WORKFLOW_TEMPLATES` 数组末尾添加：

```typescript
{
  id: 'product-replace',
  name: '产品替换',
  icon: '🔄',
  description: '替换场景中的产品',
  prompt: '将图1的产品放到图2的场景中，替换原有的产品，重新打光，使产品和场景融合自然，有自然光影，产品保持一致，去除场景中的文字和logo'
}
```

### 2. 添加图片上传顺序提示

在工作流模式的图片上传区域（[`App.tsx:637-638`](image-gen-app/src/App.tsx:637)）添加提示文本：

修改前：
```typescript
<div className="label">参考图片（必需，支持多张）</div>
```

修改后：
```typescript
<div className="label">
  参考图片（必需，支持多张）
  {selectedWorkflow?.id === 'product-replace' && (
    <div style={{fontSize: '12px', color: 'var(--muted2)', marginTop: '4px'}}>
      💡 提示：第一张为产品图，第二张为场景图
    </div>
  )}
</div>
```

### 3. 可选优化：验证图片数量

在 `onGenerate` 函数中添加验证（可选）：

```typescript
// 在工作流模式下，如果是产品替换模板，检查图片数量
if (mode === 'workflow' && selectedWorkflow?.id === 'product-replace' && inputImages.length < 2) {
  setError('产品替换模板需要至少上传两张图片（产品图和场景图）')
  setBusy(false)
  return
}
```

## 代码位置

- 模板定义：[`App.tsx:51-115`](image-gen-app/src/App.tsx:51) 的 `WORKFLOW_TEMPLATES` 数组
- 图片上传标签：[`App.tsx:637-638`](image-gen-app/src/App.tsx:637)
- 生成函数：[`App.tsx:239-302`](image-gen-app/src/App.tsx:239) 的 `onGenerate` 函数

## 测试要点

1. 模板卡片是否正确显示
2. 选择模板后，图片上传提示是否显示
3. 上传两张图片后，生成功能是否正常
4. 图片顺序是否正确传递给 API
5. 历史记录是否正确保存